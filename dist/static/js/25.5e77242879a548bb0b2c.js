webpackJsonp([25],{"2aE2":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"model-search clearfix"},[i("el-select",{attrs:{size:"small",filterable:"",clearable:"",placeholder:"城市"},on:{change:function(t){e.searchParam()}},model:{value:e.searchParams.cityId,callback:function(t){e.$set(e.searchParams,"cityId",t)},expression:"searchParams.cityId"}},e._l(e.cityList,function(e){return i("el-option",{key:e.cityId,attrs:{label:e.cityName,value:e.cityId}})})),e._v(" "),i("el-select",{staticStyle:{"margin-left":"10px"},attrs:{clearable:"",size:"small",placeholder:"大麦状态"},on:{change:function(t){e.searchParam()}},model:{value:e.searchParams.status,callback:function(t){e.$set(e.searchParams,"status",t)},expression:"searchParams.status"}},e._l(e.selectData,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),i("el-button",{staticClass:"right",attrs:{type:"primary",icon:"el-icon-plus",size:"small"},nativeOn:{click:function(t){e.handleDetail()}}},[e._v("新增")])],1),e._v(" "),i("GridUnit",{ref:"refGridUnit",attrs:{columns:e.colModels,url:e.url,formOptions:e.searchParams,dataMethod:e.method,height:e.tableHeight},scopedSlots:e._u([{key:"handle",fn:function(t){return[i("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:function(i){e.handleDetail(t.row)}}},[e._v("\n        编辑\n      ")]),e._v(" "),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(i){e.handleDelete(t.row)}}},[e._v("\n        删除\n      ")])]}}])}),e._v(" "),i("div",{staticClass:"dialog-info"},[i("el-dialog",{attrs:{title:e.temp.id?"编辑大麦消息":"新增大麦消息",visible:e.layer_showInfo},on:{"update:visible":function(t){e.layer_showInfo=t},close:e.dialogClose}},[i("el-form",{ref:"dataForm",attrs:{size:"small","status-icon":"",rules:e.rules,model:e.temp,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"请输入标题",maxlength:20},model:{value:e.temp.title,callback:function(t){e.$set(e.temp,"title",t)},expression:"temp.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"链接",prop:"newsUrl"}},[i("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入有效链接"},model:{value:e.temp.newsUrl,callback:function(t){e.$set(e.temp,"newsUrl",t)},expression:"temp.newsUrl"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"上线时间",prop:"effectiveTime"}},[i("el-date-picker",{key:"effectiveTime",attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择上线时间",disabled:e.temp.status&&1!==e.temp.status||e.temp.nowOnline},on:{change:e.startChange},model:{value:e.temp.effectiveTime,callback:function(t){e.$set(e.temp,"effectiveTime",t)},expression:"temp.effectiveTime"}}),e._v(" "),i("el-checkbox",{staticClass:"filter-item",on:{change:e.changeOnline},model:{value:e.temp.nowOnline,callback:function(t){e.$set(e.temp,"nowOnline",t)},expression:"temp.nowOnline"}},[e._v("立即上线")])],1),e._v(" "),i("el-form-item",{attrs:{label:"下线时间",prop:"ineffectiveTime"}},[i("el-date-picker",{key:"ineffectiveTime",attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择下线时间",disabled:e.temp.status&&1!==e.temp.status||e.temp.nowOffline},on:{change:e.endChange},model:{value:e.temp.ineffectiveTime,callback:function(t){e.$set(e.temp,"ineffectiveTime",t)},expression:"temp.ineffectiveTime"}}),e._v(" "),i("el-checkbox",{staticClass:"filter-item",on:{change:e.changeOffline},model:{value:e.temp.nowOffline,callback:function(t){e.$set(e.temp,"nowOffline",t)},expression:"temp.nowOffline"}},[e._v("立即下线")])],1),e._v(" "),i("el-form-item",{attrs:{label:"投放城市"}},[i("el-select",{attrs:{size:"small",clearable:"",filterable:"",placeholder:"全部城市"},model:{value:e.temp.cityId,callback:function(t){e.$set(e.temp,"cityId",t)},expression:"temp.cityId"}},e._l(e.cityList,function(e){return i("el-option",{key:e.cityId,attrs:{label:e.cityName,value:e.cityId}})}))],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.layer_showInfo=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveData}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]}},NZFK:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("4YfN"),n=i.n(a),l=i("cAgV"),s=i("U4Ig"),r=i.n(s),c=i("0xDb"),o=i("E4LH"),f=i("tDxQ");t.default={name:"infomation",directives:{waves:l.a},components:{GridUnit:r.a},data:function(){return{searchParams:{status:"",cityId:""},cityList:[],selectData:[{value:1,label:"待上线"},{value:2,label:"已上线"},{value:3,label:"已下线"}],colModels:[{prop:"newsStatus",label:"状态",width:80,type:"status",unitFilters:{renderStatusType:function(e){return{1:"info",2:"success",3:"danger"}[e]||"info"},renderStatusValue:function(e){return["待上线","已上线","已下线"][e-1]||"待上线"}}},{prop:"cityName",label:"城市"},{prop:"title",label:"标题"},{prop:"newsUrl",label:"链接",type:"link"},{prop:"effectiveTime",label:"上线时间",width:180,filter:"parseTime"},{prop:"ineffectiveTime",label:"下线时间",width:180,filter:"parseTime"},{label:"操作",slotName:"handle",width:200,fixed:"right",align:"center"}],tableHeight:300,url:f.d.defaultOptions.requestUrl,method:f.d.defaultOptions.method,temp:{nowOnline:!1,nowOffline:!1},actionBaseUrl:"https://api.mdguanjia.com/bop/",layer_showInfo:!1,rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],newsUrl:[{required:!0,validator:function(e,t,i){Object(o.c)(t)?i():i(new Error("请输入合法的链接"))},trigger:"blur"}],effectiveTime:[{required:!0,message:"请选择上线时间",trigger:"change"}],ineffectiveTime:[{required:!0,message:"请选择下线时间",trigger:"change"}]}}},created:function(){var e=this;f.a.cityList().then(function(t){e.cityList=t.data})},mounted:function(){var e=this;this.$nextTick(function(){var t=e.$refs.refGridUnit.$el.offsetTop||140,i=document.body.clientHeight-t-64-20;e.tableHeight=i>300?i:300,window.onresize=function(){return i=document.body.clientHeight-t-64-20,void(e.tableHeight=e.tableHeight=i>300?i:300)}})},computed:{tableStyle:function(){return{width:"100%",height:this.tableHeight+"px"}}},methods:{searchParam:function(){this.$refs.refGridUnit.searchHandler()},startChange:function(e){this.temp.effectiveTime=e},endChange:function(e){this.temp.ineffectiveTime=e},changeOnline:function(e){this.temp.effectiveTime=Object(c.d)(new Date),e&&(this.temp.nowOffline=!1)},changeOffline:function(e){this.temp.ineffectiveTime=Object(c.d)(new Date),e&&(this.temp.nowOnline=!1)},handleDelete:function(e){var t=this;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){f.d.delete({id:e.id}).then(function(e){t.searchParam(),t.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3})})}).catch(function(){})},handleDetail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(c.c)(e),i=t.effectiveTime,a=t.ineffectiveTime;this.temp=n()({},t,{effectiveTime:i?Object(c.d)(i):"",ineffectiveTime:a?Object(c.d)(a):"",nowOffline:!1,nowOnline:!1,cityId:t.cityId||this.searchParams.cityId}),this.layer_showInfo=!0},saveData:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){if(e.temp.effectiveTime>=e.temp.ineffectiveTime)return e.$message.error("上线时间必须小于下线时间"),!1;var i=e.temp.id?f.d.edit:f.d.add,a=e.temp,n=a.id,l=a.title,s=a.newsUrl,r=a.effectiveTime,o=a.ineffectiveTime,m=a.cityId,d=e.temp.nowOnline?2:e.temp.nowOffline?3:1;i(Object(c.a)({id:n,title:l,newsUrl:s,effectiveTime:r,ineffectiveTime:o,cityId:m,status:d})).then(function(t){e.searchParam(),e.layer_showInfo=!1,e.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3})})}})},dialogClose:function(){this.$refs.dataForm.resetFields(),this.layer_showInfo=!1,this.temp={nowOffline:!1,nowOnline:!1}}}}},PUjD:function(e,t,i){var a=i("aGWH");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("8bSs")("721da87e",a,!0)},aGWH:function(e,t,i){(e.exports=i("BkJT")(!1)).push([e.i,"",""])},ebl5:function(e,t,i){var a=i("Alxp")(i("NZFK"),i("2aE2"),function(e){i("PUjD")},null,null);e.exports=a.exports}});