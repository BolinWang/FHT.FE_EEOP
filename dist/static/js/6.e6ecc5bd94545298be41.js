webpackJsonp([6,27],{"4Emy":function(e,t,o){(e.exports=o("BkJT")(!1)).push([e.i,".upload-pics-model .previewItems[data-v-7ef046b2]{margin-bottom:10px}.upload-pics-model .previewItems .el-upload--picture-card.uploadImage[data-v-7ef046b2]{width:122px;height:92px;line-height:98px}.upload-pics-model .upload-pics-info[data-v-7ef046b2]{margin:0 0 5px}",""])},"8Y6n":function(e,t,o){var a=o("Alxp")(o("hYRi"),o("95c3"),function(e){o("j/ji")},"data-v-18fb04d4",null);e.exports=a.exports},"95c3":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("el-row",{staticClass:"room-options-row"},[o("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-arrow-left"},on:{click:function(t){e.$router.push({name:"集中式房源"})}}},[e._v("返回")]),e._v(" "),o("el-dropdown",{staticClass:"room-options-dropdown",on:{command:e.handleCommand}},[o("el-button",{attrs:{plain:"",size:"small"}},[e._v("批量房态管理")]),e._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:2}},[e._v("空房")]),e._v(" "),o("el-dropdown-item",{attrs:{command:9}},[e._v("已出租无租客")])],1)],1),e._v(" "),o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.openRoomDetailModel(1)}}},[e._v("新建房号")]),e._v(" "),o("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.deleteRoom}},[e._v("删除房号")]),e._v(" "),e.estateInfo.estateName?[o("span",{staticClass:"estate-title"},[e._v(e._s(e.estateInfo.estateName))]),e._v(" "),o("span",{staticClass:"estate-address"},[e._v(e._s(e.estateInfo.subdistrictName+" - "+e.estateInfo.subdistrictAddress))])]:e._e()],2),e._v(" "),o("el-form",{ref:"form",staticClass:"room-search-form",attrs:{inline:!0,model:e.roomSearchForm,size:"small"}},[o("el-form-item",{staticClass:"room-search-form-group"},[o("el-select",{attrs:{placeholder:"楼层"},model:{value:e.roomSearchForm.floorId,callback:function(t){e.$set(e.roomSearchForm,"floorId",t)},expression:"roomSearchForm.floorId"}},e._l(e.estateInfo.floors,function(e){return o("el-option",{key:e.floorId,attrs:{label:e.floorName,value:e.floorId}})}))],1),e._v(" "),o("el-form-item",{staticClass:"room-search-form-group"},[o("el-select",{attrs:{placeholder:"房间状态"},model:{value:e.roomSearchForm.roomStatus,callback:function(t){e.$set(e.roomSearchForm,"roomStatus",t)},expression:"roomSearchForm.roomStatus"}},e._l(e.roomStatusList,function(e,t){return o("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{staticClass:"room-search-form-group"},[o("el-input",{attrs:{placeholder:"房源编码"},model:{value:e.roomSearchForm.roomCode,callback:function(t){e.$set(e.roomSearchForm,"roomCode",t)},expression:"roomSearchForm.roomCode"}})],1),e._v(" "),o("el-form-item",{staticClass:"room-search-form-group"},[o("el-input",{attrs:{placeholder:"房号"},model:{value:e.roomSearchForm.roomNo,callback:function(t){e.$set(e.roomSearchForm,"roomNo",t)},expression:"roomSearchForm.roomNo"}})],1),e._v(" "),o("el-form-item",{staticClass:"room-search-form-group"},[o("el-select",{attrs:{placeholder:"标签"},model:{value:e.roomSearchForm.tag,callback:function(t){e.$set(e.roomSearchForm,"tag",t)},expression:"roomSearchForm.tag"}},[o("el-option",{attrs:{label:"飞虎队",value:"fhd"}})],1)],1),e._v(" "),o("el-form-item",{staticClass:"room-search-form-group"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.searchEstateRoomList("search")}}},[e._v("查询")]),e._v(" "),o("el-button",{on:{click:function(t){e.searchEstateRoomList("clear")}}},[e._v("清空")])],1)],1),e._v(" "),o("grid-unit",{ref:"estateRoomList",attrs:{url:e.estateRoomListUrl,listField:"data.result",totalField:"data.records",dataMethod:e.reqMethod,formOptions:e.roomSearchForm,showSelection:!0,columns:e.colModels,height:e.tableHeight,pageSizes:[20,50,100,200]},on:{"selection-change":e.handleSelectionChange},scopedSlots:e._u([{key:"setTag",fn:function(t){return[1===t.row.tag?o("el-tag",[e._v("飞虎队")]):e._e()]}},{key:"floorName",fn:function(t){return[e._v("\n      "+e._s(e._f("setFloorName")(t.row.floorId,e.estateInfo.floors))+"\n    ")]}},{key:"roomStatus",fn:function(t){return[o("el-tag",{attrs:{type:[2].includes(t.row.roomStatus)?"success":[5,6,8,10].includes(t.row.roomStatus)?"info":"danger"}},[e._v(e._s(e._f("setRoomStatus")(t.row.roomStatus,e.roomStatusList)))])]}},{key:"settingRoom",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.openRentPayModel(t.row)}}},[e._v("交租方式")]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.openCopyItemToModel(t.row)}}},[e._v("复制到")]),e._v(" "),o("el-dropdown",{attrs:{"hide-on-click":!1},on:{command:e.handleCommand}},[o("el-button",{staticClass:"settingRoom-btn",attrs:{size:"mini"}},[e._v("房态管理")]),e._v(" "),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:{roomCodes:[t.row.roomCode],roomStatus:2}}},[e._v("空房")]),e._v(" "),o("el-dropdown-item",{attrs:{command:{roomCodes:[t.row.roomCode],roomStatus:9}}},[e._v("已出租无租客")])],1)],1)]}},{key:"operateRoom",fn:function(t){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){e.openRoomDetailModel(2,t.row)}}},[e._v("编辑房间")])]}}])},[o("el-table-column",{attrs:{slot:"selection",type:"selection"},slot:"selection"})],1),e._v(" "),o("el-dialog",{staticClass:"copy-item-to-model",attrs:{title:"复制到",visible:e.copyItemToModelVisible,width:"700px"},on:{"update:visible":function(t){e.copyItemToModelVisible=t}}},[o("room-list-selecter",{ref:"copyItemTo",attrs:{roomList:e.copyItemRoomList,visible:e.copyItemToModelVisible}},[o("el-card",{staticClass:"head-card"},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[o("div",{attrs:{slot:"content"},slot:"content"},[e._v("选择复制您要的内容，再选择您要编辑的房间，"),o("br"),e._v("这样可以方便您快速批量编辑同类房源")]),e._v(" "),o("span",{staticClass:"head-card-title"},[e._v("复制项目\n              "),o("i",{staticClass:"el-icon-warning"})])]),e._v(" "),o("div",{staticClass:"check-all"},[o("el-form",{attrs:{inline:!0,size:"mini"}},[o("el-form-item",{attrs:{label:e.checkAllCopyItem?"取消全选":"全选"}},[o("el-switch",{on:{change:e.handleCheckAllChange},model:{value:e.checkAllCopyItem,callback:function(t){e.checkAllCopyItem=t},expression:"checkAllCopyItem"}})],1)],1)],1)],1),e._v(" "),o("el-checkbox-group",{model:{value:e.checkedCopyList,callback:function(t){e.checkedCopyList=t},expression:"checkedCopyList"}},e._l(e.copyOptions,function(t){return o("el-checkbox",{key:t.val,staticClass:"head-check-options",attrs:{label:t.val},on:{change:e.handleOptionsChange}},[e._v("\n            "+e._s(t.label)+"\n          ")])}))],1),e._v(" "),o("span",{attrs:{slot:"card-title"},slot:"card-title"},[e._v("请选择要复制到的房间号")])],1),e._v(" "),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveCopyItemTo}},[e._v("确 定")]),e._v(" "),o("el-button",{attrs:{size:"small"},on:{click:function(t){e.copyItemToModelVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),o("el-dialog",{staticClass:"rent-pay-model",attrs:{title:"交租方式",visible:e.rentPayModelVisible,width:2!==e.curRoomFinanceType?"1000px":"700px"},on:{"update:visible":function(t){e.rentPayModelVisible=t}}},[o("rent-pay-way",{ref:"rentPayWay",attrs:{list:e.rentPayList,curRoomFinanceType:e.curRoomFinanceType,baseRentTypeList:e.baseRentTypeList}}),e._v(" "),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveRentPay}},[e._v("保 存")]),e._v(" "),o("el-button",{attrs:{size:"small"},on:{click:function(t){e.rentPayModelVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),o("el-dialog",{staticClass:"room-detail-model",attrs:{title:1===e.curType?"新建房号":"编辑房号",visible:e.roomDetailModelVisible,"before-close":e.checkEditStatus,width:"800px"},on:{"update:visible":function(t){e.roomDetailModelVisible=t}}},[o("room-detail",{ref:"roomDetailModel",attrs:{type:e.curType,modelVisible:e.roomDetailModelVisible,estateInfo:e.estateInfo}}),e._v(" "),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveRoomData}},[e._v(e._s(1===e.curType?"确 定":"保 存"))]),e._v(" "),o("el-button",{attrs:{size:"small"},on:{click:function(t){e.roomDetailModelVisible=!1}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]}},C5t1:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("lC5x"),r=o.n(a),l=o("hRKE"),s=o.n(l),i=o("rVsN"),n=o.n(i),c=o("J0Oq"),m=o.n(c),d=o("IHPB"),p=o.n(d),u=o("3cXf"),f=o.n(u),h=o("ZLEe"),v=o.n(h),b=o("0xDb"),g=o("H1GV"),y=o.n(g),C=o("fDDG"),D=o.n(C);t.default={name:"roomDetailModel",components:{Preview:y.a,ImageCropper:D.a},props:["type","modelVisible","estateInfo"],data:function(){return{roomDetailModel:{},tempFormData:{},roomDetailModelRules:{estateName:[{required:!0,message:"请输入公寓名称",trigger:"change"}],floorId:[{required:!0,message:"请选择楼层",trigger:"change"}],roomCode:[{required:!0,message:"请输入房号",trigger:"change"}],startNo:[{required:!0,message:"请输入起始房号",trigger:"change"}],roomTypeId:[{required:!0,message:"请选择房间类型",trigger:"change"}],chamberCount:[{required:!0,message:"请输入值",trigger:"change"}],toiletCount:[{required:!0,message:"请输入值",trigger:"change"}],boardCount:[{required:!0,message:"请输入值",trigger:"change"}],roomArea:[{required:!0,message:"请输入房间面积",trigger:"change"}],decorationDegree:[{required:!0,message:"请选择装修程度",trigger:"change"}],roomDirection:[{required:!0,message:"请选择房间朝向",trigger:"change"}],maxPerson:[{required:!0,message:"请输入房间最多入住人数",trigger:"change"}],bedCount:[{required:!0,message:"请输入房间床数",trigger:"change"}]},decorationDegreeList:[{label:"毛坯",value:1},{label:"简装",value:2},{label:"精装修",value:3},{label:"豪华装",value:4}],roomDirectionList:[{label:"朝南",value:1},{label:"朝北",value:2},{label:"朝东",value:3},{label:"朝西",value:4},{label:"东南",value:5},{label:"西南",value:6},{label:"东北",value:7},{label:"西北",value:8}],uploadPicsModelVisible:!1,cropperList:[],accept:"image/png, image/jpeg, image/jpg"}},methods:{openPicListModel:function(){this.uploadPicsModelVisible=!0},checkEditFlag:function(){var e=this,t=!1;return v()(this.tempFormData).forEach(function(o){if(f()(e.tempFormData[o])!=f()(e.roomDetailModel[o])){"pictureList"===o?(a=e.tempFormData[o],r=e.roomDetailModel[o],l=0,t=a.length!==r.length?++l:(a.forEach(function(e,t){e.imageName!==r[t].imageName&&l++}),l>0)):t=!0}var a,r,l}),t},emitDelete:function(e){this.roomDetailModel.pictureList=e},emitCropperList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.cropperList=e},emitCropperData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach(function(e,t){e.type=1,e.imageName=e.title,e.image=e.src,e.key=e.key||Math.random().toFixed(5)});var t=[].concat(p()(this.roomDetailModel.pictureList),p()(e));this.$set(this.roomDetailModel,"pictureList",t)},uploadImg:function(e){var t=this;return m()(r.a.mark(function o(){var a,l,i,c,m;return r.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e.target.value){o.next=3;break}return console.log("取消上传..."),o.abrupt("return",!1);case 3:if(a=[],l=function(e){return new n.a(function(t){var o=new FileReader;o.onerror=function(e){console.log("读取异常....")},o.onload=function(o){var a="object"===s()(o.target.result)?window.URL.createObjectURL(new Blob([o.target.result])):o.target.result,r="";r=e.name?e.name.split(".")[0].length<=30?e.name.split(".")[0]:e.name.split(".")[0].substr(0,30):"",t({img:a,imageName:r,type:1})},o.readAsArrayBuffer(e)})},i=e.target.files,!((c=t.roomDetailModel.pictureList).length+i.length>15)){o.next=11;break}return t.$message.error("您已上传"+c.length+"张图片，最多还能上传"+(15-c.length)+"张图片"),e.target.value=null,o.abrupt("return",!1);case 11:m=0;case 12:if(!(m<i.length)){o.next=25;break}if(t.accept.includes(i[m].type)){o.next=17;break}return t.$message.error("请上传"+t.accept.replace(/image\//gi,"")+"的图片"),e.target.value=null,o.abrupt("return",!1);case 17:return o.t0=a,o.next=20,l(i[m]);case 20:o.t1=o.sent,o.t0.push.call(o.t0,o.t1);case 22:m++,o.next=12;break;case 25:t.cropperList=a.map(function(e,t){return{img:e.img,imageName:e.imageName,type:e.type}}),e.target.value=null;case 27:case"end":return o.stop()}},o,t)}))()},saveRoomData:function(){var e=this,t=!1;return this.$refs.roomDetailModel.validate(function(o){o&&(t=Object(b.d)(e.roomDetailModel),2===e.type&&(t.uploadPictureList=t.pictureList.filter(function(e){return e.isBase64}),t.pictureList=t.pictureList.filter(function(e){return!e.isBase64})),t.skipNo=t.skipNo?t.skipNo.join(","):[],t.tag=t.tag?1:0)}),t}},watch:{modelVisible:{immediate:!0,handler:function(e){var t=this;if(e){1===this.type&&this.$set(this.roomDetailModel,"estateName",this.estateInfo.estateName);var o=Object(b.d)(this.$store.state.estateDetailData.estateRoomInfo);o.tag=1===o.tag,2===this.type&&o.pictureList.forEach(function(e){e.src=e.imageUrl,e.title=e.imageName,e.key=Math.random().toFixed(5)}),2===this.type&&this.$set(this,"roomDetailModel",o),this.$nextTick(function(){t.$refs.roomDetailModel.clearValidate(),t.$set(t,"tempFormData",Object(b.d)(t.roomDetailModel))})}else v()(this.roomDetailModel).forEach(function(e){t.roomDetailModel[e]="[object Array]"===Object.prototype.toString.call(t.roomDetailModel[e])?[]:""})}}}}},CaX9:function(e,t,o){(e.exports=o("BkJT")(!1)).push([e.i,".room-options-row[data-v-18fb04d4]{margin-bottom:20px}.room-options-row .room-options-dropdown[data-v-18fb04d4]{margin:0 10px}.room-options-row .estate-title[data-v-18fb04d4]{display:inline-block;vertical-align:middle;margin-left:50px;font-size:24px;line-height:1}.room-options-row .estate-address[data-v-18fb04d4]{display:inline-block;vertical-align:middle;max-width:500px;overflow:hidden;font-size:14px;line-height:1;margin-left:20px}.room-search-form .room-search-form-group[data-v-18fb04d4]{margin-bottom:10px}.room-search-form .room-search-form-group.right[data-v-18fb04d4]{margin-right:0}.settingRoom-btn[data-v-18fb04d4]{margin-left:10px}.copy-item-to-model .head-card[data-v-18fb04d4]{-webkit-box-shadow:0 0;box-shadow:0 0;margin-bottom:20px}.copy-item-to-model .head-card .head-card-title i[data-v-18fb04d4]{margin-left:5px;color:#409eff}.copy-item-to-model .head-card .check-all[data-v-18fb04d4]{float:right;position:relative}.copy-item-to-model .head-card .check-all .el-form-item[data-v-18fb04d4]{margin-bottom:0}.copy-item-to-model .head-card .head-check-options[data-v-18fb04d4]{width:20%;margin-left:0}.finance-rent-pay-way[data-v-18fb04d4]{margin-bottom:15px}.finance-rent-pay-way .service-charge-price-percent[data-v-18fb04d4]{line-height:66px;text-align:center}.rent-pay-model-row[data-v-18fb04d4]{margin-bottom:15px}.rent-pay-model-row .el-col:last-child .delete-btn[data-v-18fb04d4]{padding:3px 0;font-size:18px;color:red}.rent-pay-model-row .lease-term[data-v-18fb04d4]{width:100px}.default-rent-pay-way[data-v-18fb04d4]{margin-bottom:15px}.default-rent-pay-way .delete-btn[data-v-18fb04d4]{padding:3px 0;font-size:18px;color:red}.default-rent-pay-way .service-charge-price-percent[data-v-18fb04d4]{line-height:66px;text-align:center}",""])},Ee8N:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"room-detail-container estate-room-detail"},[o("el-form",{ref:"roomDetailModel",attrs:{model:e.roomDetailModel,rules:e.roomDetailModelRules,"label-width":"110px",size:"small"}},[1===e.type?[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"公寓",prop:"estateName"}},[o("el-input",{attrs:{disabled:""},model:{value:e.estateInfo.estateName,callback:function(t){e.$set(e.estateInfo,"estateName",t)},expression:"estateInfo.estateName"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"楼层",prop:"floorId"}},[o("el-select",{staticClass:"room-detail-select",attrs:{placeholder:"请选择"},model:{value:e.roomDetailModel.floorId,callback:function(t){e.$set(e.roomDetailModel,"floorId",t)},expression:"roomDetailModel.floorId"}},e._l(e.estateInfo.floors,function(e){return o("el-option",{key:e.floorId,attrs:{label:e.floorName,value:e.floorId}})}))],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"起始房号",prop:"startNo"}},[o("el-input",{attrs:{placeholder:"例: 101"},model:{value:e.roomDetailModel.startNo,callback:function(t){e.$set(e.roomDetailModel,"startNo",t)},expression:"roomDetailModel.startNo"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"末尾房号",prop:""}},[o("el-input",{attrs:{placeholder:"例: 120"},model:{value:e.roomDetailModel.endNo,callback:function(t){e.$set(e.roomDetailModel,"endNo",t)},expression:"roomDetailModel.endNo"}})],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"跳过尾号",prop:""}},[o("el-select",{staticClass:"room-detail-select",attrs:{multiple:"",placeholder:"请选择"},model:{value:e.roomDetailModel.skipNo,callback:function(t){e.$set(e.roomDetailModel,"skipNo",t)},expression:"roomDetailModel.skipNo"}},e._l(10,function(e,t){return o("el-option",{key:t,attrs:{label:t,value:t}})}))],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"房间类型",prop:"roomTypeId"}},[o("el-select",{staticClass:"room-detail-select",attrs:{placeholder:"请选择"},model:{value:e.roomDetailModel.roomTypeId,callback:function(t){e.$set(e.roomDetailModel,"roomTypeId",t)},expression:"roomDetailModel.roomTypeId"}},e._l(e.estateInfo.roomTypeList,function(e){return o("el-option",{key:e.id,attrs:{label:e.styleName,value:e.id}})}))],1)],1)],1)]:[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"楼层",prop:"floorId"}},[o("el-select",{staticClass:"room-detail-select",attrs:{placeholder:"请选择"},model:{value:e.roomDetailModel.floorId,callback:function(t){e.$set(e.roomDetailModel,"floorId",t)},expression:"roomDetailModel.floorId"}},e._l(e.estateInfo.floors,function(e){return o("el-option",{key:e.floorId,attrs:{label:e.floorName,value:e.floorId}})}))],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"房号",prop:"roomNo"}},[o("el-input",{attrs:{type:"number"},model:{value:e.roomDetailModel.roomNo,callback:function(t){e.$set(e.roomDetailModel,"roomNo",t)},expression:"roomDetailModel.roomNo"}})],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"房间类型",prop:"roomTypeId"}},[o("el-select",{staticClass:"room-detail-select",attrs:{placeholder:"请选择"},model:{value:e.roomDetailModel.roomTypeId,callback:function(t){e.$set(e.roomDetailModel,"roomTypeId",t)},expression:"roomDetailModel.roomTypeId"}},e._l(e.estateInfo.roomTypeList,function(e){return o("el-option",{key:e.id,attrs:{label:e.styleName,value:e.id}})}))],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"房间照片",prop:""}},[o("el-badge",{attrs:{value:e.roomDetailModel.pictureList?e.roomDetailModel.pictureList.length:0}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.openPicListModel}},[e._v("上传照片")])],1)],1)],1)],1)],e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{staticClass:"room-count",attrs:{label:"室厅卫",prop:"chamberCount","show-message":!1}},[o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"",prop:"chamberCount"}},[o("el-input",{attrs:{type:"number"},model:{value:e.roomDetailModel.chamberCount,callback:function(t){e.$set(e.roomDetailModel,"chamberCount",t)},expression:"roomDetailModel.chamberCount"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:2}},[e._v("\n              室\n            ")]),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"",prop:"boardCount"}},[o("el-input",{attrs:{type:"number"},model:{value:e.roomDetailModel.boardCount,callback:function(t){e.$set(e.roomDetailModel,"boardCount",t)},expression:"roomDetailModel.boardCount"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:2}},[e._v("\n              厅\n            ")]),e._v(" "),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"room-item-count",attrs:{label:"",prop:"toiletCount"}},[o("el-input",{attrs:{type:"number"},model:{value:e.roomDetailModel.toiletCount,callback:function(t){e.$set(e.roomDetailModel,"toiletCount",t)},expression:"roomDetailModel.toiletCount"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:2}},[e._v("\n              卫\n            ")])],1)],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"面积",prop:"roomArea"}},[o("el-input",{attrs:{type:"number",placeholder:"请输入内容"},model:{value:e.roomDetailModel.roomArea,callback:function(t){e.$set(e.roomDetailModel,"roomArea",t)},expression:"roomDetailModel.roomArea"}},[o("template",{attrs:{slot:"append"},slot:"append"},[e._v("m\n              "),o("sup",[e._v("2")])])],2)],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"装修程度",prop:"decorationDegree"}},[o("el-select",{staticClass:"room-detail-select",attrs:{placeholder:"请选择"},model:{value:e.roomDetailModel.decorationDegree,callback:function(t){e.$set(e.roomDetailModel,"decorationDegree",t)},expression:"roomDetailModel.decorationDegree"}},e._l(e.decorationDegreeList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"朝向",prop:"roomDirection"}},[o("el-select",{staticClass:"room-detail-select",attrs:{placeholder:"请选择"},model:{value:e.roomDetailModel.roomDirection,callback:function(t){e.$set(e.roomDetailModel,"roomDirection",t)},expression:"roomDetailModel.roomDirection"}},e._l(e.roomDirectionList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"最多入住人数",prop:"maxPerson"}},[o("el-input",{attrs:{type:"number"},model:{value:e.roomDetailModel.maxPerson,callback:function(t){e.$set(e.roomDetailModel,"maxPerson",t)},expression:"roomDetailModel.maxPerson"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"床数",prop:"bedCount"}},[o("el-input",{attrs:{type:"number"},model:{value:e.roomDetailModel.bedCount,callback:function(t){e.$set(e.roomDetailModel,"bedCount",t)},expression:"roomDetailModel.bedCount"}})],1)],1)],1),e._v(" "),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:"飞虎队"}},[o("el-checkbox",{model:{value:e.roomDetailModel.tag,callback:function(t){e.$set(e.roomDetailModel,"tag",t)},expression:"roomDetailModel.tag"}})],1)],1)],1)],2),e._v(" "),o("el-dialog",{attrs:{title:"上传照片",visible:e.uploadPicsModelVisible,width:"600px","append-to-body":!0,"custom-class":"upload-pics-model"},on:{"update:visible":function(t){e.uploadPicsModelVisible=t}}},[o("div",{staticClass:"previewItems"},[o("preview",{attrs:{"pic-list":e.roomDetailModel.pictureList,"delete-icon":"delete",disabled:""},on:{emitDelete:e.emitDelete}}),e._v(" "),o("label",{staticClass:"el-upload el-upload--picture-card uploadImage",attrs:{for:"uploadImages"}},[o("i",{staticClass:"el-icon-plus"}),e._v(" "),o("input",{attrs:{type:"file",id:"uploadImages",accept:e.accept,multiple:""},on:{change:function(t){e.uploadImg(t)}}})])],1),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("温馨提示： ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("1.请勿上传虚假、模糊、与房源信息无关、含有其他公司水印的照片； ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("2.房间照片最佳组合：卧室2~6张、公共区域1~4张、厨房1~3张、卫生间1-4张； ")]),e._v(" "),o("p",{staticClass:"upload-pics-info"},[e._v("3.目前最多支持15张，支持JPG/JPEG/PNG，可以拖动图片进行排序，支持批量上传。")]),e._v(" "),o("ImageCropper",{attrs:{cropperList:e.cropperList},on:{emitCropperList:e.emitCropperList,emitCropperData:e.emitCropperData}}),e._v(" "),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.uploadPicsModelVisible=!1}}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]}},g6eu:function(e,t,o){var a=o("Alxp")(o("C5t1"),o("Ee8N"),function(e){o("r71q")},"data-v-7ef046b2",null);e.exports=a.exports},hYRi:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("3cXf"),r=o.n(a),l=o("ZLEe"),s=o.n(l),i=o("U4Ig"),n=o.n(i),c=o("QHcW"),m=o("c5or"),d=o.n(m),p=o("g6eu"),u=o.n(p),f=o("eDc8"),h=o.n(f);t.default={name:"singleEstateRoom",components:{GridUnit:n.a,RoomListSelecter:d.a,RoomDetail:u.a,rentPayWay:h.a},data:function(){return{fangyuanCode:"",curRoomCode:"",estateInfo:{},roomSearchForm:{fangyuanCode:"",roomStatus:"",floorId:"",roomCode:"",roomNo:"",tag:""},roomStatusList:[{label:"可用",value:2},{label:"在住",value:4},{label:"维修",value:5},{label:"空脏",value:6},{label:"已出租（无租客）",value:9},{label:"装修中",value:10}],estateRoomListUrl:"/market/fangyuan",tableHeight:500,reqMethod:"queryEstateRoomList",colModels:[{slot:"selection"},{prop:"roomTypeName",label:"房间类型"},{prop:"floorId",label:"楼层",slotName:"floorName"},{prop:"roomNo",label:"房号"},{prop:"roomDirection",label:"朝向",render:function(e){return["","朝南","朝北","朝东","朝西","东南","西南","东北","西北"][e.roomDirection]}},{prop:"roomStatus",label:"房间状态",slotName:"roomStatus"},{prop:"roomCode",label:"平台房源编码"},{prop:"roomLayout",label:"室厅卫",render:function(e){return(e.chamberCount||0)+"室"+(e.boardCount||0)+"厅"+(e.toiletCount||0)+"卫"}},{prop:"roomArea",label:"面积"},{prop:"decorationDegree",label:"装修程度",render:function(e){return["","毛坯","简装","精装修","豪华装"][e.decorationDegree]}},{prop:"bedCount",label:"床数"},{prop:"maxPerson",label:"最大入住人数"},{prop:"tag",label:"标签",align:"center",slotName:"setTag"},{prop:"settings",label:"设置",width:"280px",align:"center",fixed:"right",slotName:"settingRoom"},{prop:"operate",label:"操作",align:"center",fixed:"right",slotName:"operateRoom"},{prop:"operateRecord",label:"操作记录",render:function(e){return e.lastOperator+" "+e.lastOperateTime}}],copyItemToModelVisible:!1,copyItemRoomList:{},checkAllCopyItem:!1,copyOptions:[{label:"交租方式",val:1},{label:"房间类型",val:2},{label:"室卫厅",val:3},{label:"面积",val:4},{label:"装修程度",val:5},{label:"朝向",val:6},{label:"床数",val:7},{label:"最大入住人数",val:8},{label:"飞虎队",val:10}],checkedCopyList:[],rentPayModelVisible:!1,rentPayList:[],serviceChargeTypeList:[{label:"无",value:1},{label:"固定金额",value:2},{label:"租金百分比",value:3}],serviceFeeTypeList:[{label:"随租金付",value:2},{label:"一次性付清",value:3}],baseRentTypeList:[],roomDetailModelVisible:!1,curType:"",selectedRooms:[],roomStatusEndDate:"",tempRoomStatusParams:{endDate:"",roomCodes:"",roomStatus:null},curRoomFinanceType:1}},computed:{allCheckedOptionsList:function(){return this.copyOptions.map(function(e){return e.val})}},methods:{searchParam:function(){this.$refs.estateRoomList.searchHandler()},searchEstateRoomList:function(e){var t=this;"clear"===e&&s()(this.roomSearchForm).forEach(function(e){t.roomSearchForm[e]="fangyuanCode"===e?t.roomSearchForm[e]:""}),this.searchParam()},fetchEstateDetailData:function(){var e=this;Object(c.m)({fangyuanCode:this.fangyuanCode}).then(function(t){"0"===t.code&&e.$set(e,"estateInfo",t.data)})},openCopyItemToModel:function(e){var t=this;this.curRoomCode=e.roomCode,Object(c.g)({fangyuanCode:this.fangyuanCode,roomCode:e.roomCode}).then(function(e){"0"===e.code&&e.data&&(t.copyItemRoomList=e.data,t.checkedCopyList=[],t.copyItemToModelVisible=!0,t.handleOptionsChange())})},openRentPayModel:function(e){var t=this;this.curRoomCode=e.roomCode,Object(c.n)({roomCode:e.roomCode}).then(function(e){"0"===e.code&&(t.curRoomFinanceType=e.data.houseFinanceType,t.$set(t,"rentPayList",e.data.roomRentTypeList),t.$set(t,"baseRentTypeList",e.data.baseRentTypeList)),t.rentPayModelVisible=!0})},handleCheckAllChange:function(e){this.checkedCopyList=e?this.allCheckedOptionsList:[]},handleOptionsChange:function(){this.checkAllCopyItem=this.checkedCopyList.length===this.allCheckedOptionsList.length},saveCopyItemTo:function(){var e=this,t=this.$refs.copyItemTo.returnCheckedList();Object(c.d)({fromRoomCode:this.curRoomCode,toRoomCodes:t,items:this.checkedCopyList}).then(function(t){"0"===t.code&&(e.$message({message:t.message,type:"success"}),e.checkedCopyList=[],e.checkAllCopyItem=!1,e.copyItemToModelVisible=!1,e.searchParam())})},addRentPay:function(){this.rentPayList.push({depositPrice:"",depositQty:"",maxMonthNum:12,minMonthNum:1,name:"月付",rentPrice:"",rentQty:1,rentTypeId:1,roomId:this.rentPayList[0]?this.rentPayList[0].roomId:void 0,roomRentTypeId:void 0,serviceChargePrice:null,serviceChargeRatio:null,serviceChargeType:1,serviceFeeType:1,type:1})},saveRentPay:function(){var e=this,t=this.$refs.rentPayWay.returnRentPayList();if(!t)return this.$message.error("请填写完交租方式再保存"),!1;Object(c.H)({roomCode:this.curRoomCode,roomRentTypeList:t}).then(function(t){"0"===t.code&&(e.$message({message:t.message,type:"success"}),e.rentPayModelVisible=!1)})},switchRentType:function(e){var t=this.baseRentTypeList.filter(function(t){return t.rentQty===e.rentQty});s()(t[0]).forEach(function(o){"baseRentTypeId"===o?e.rentTypeId=t[0][o]:e[o]=t[0][o]}),e.minMonthNum=e.rentQty},deleteCurRentPay:function(e){this.$set(this,"rentPayList",this.rentPayList.filter(function(t){return t!=e}))},computeServiceChargePrice:function(e){3===e.serviceChargeType&&(e.serviceChargePrice=e.serviceChargeRatio*e.rentPrice/100)},switchServiceChargeType:function(e){e.serviceFeeType=1===e.serviceChargeType?1:2},openRoomDetailModel:function(e,t){var o=this;this.curType=e,2===e?Object(c.B)({roomCode:t.roomCode}).then(function(e){"0"===e.code&&(o.$store.commit("SET_ESTATEROOMDATA",e.data),o.roomDetailModelVisible=!0)}):this.roomDetailModelVisible=!0},saveRoomData:function(){var e=this,t=this.$refs.roomDetailModel.saveRoomData();t&&(t.fangyuanCode=this.fangyuanCode,2===this.curType?(t.pictureUploadList=t.pictureList.filter(function(e){return e.image}),t.pictureList=t.pictureList.filter(function(e){return e.imageUrl}),t.pictureUploadList.forEach(function(e){e.src=null}),t.pictureList.forEach(function(e){e.src=null})):(delete t.pictureList,delete t.pictureUploadList),delete t.roomStatusOperateList,console.log(t),Object(c.G)({roomInfo:r()(t)},this.curType).then(function(t){"0"===t.code&&(e.$message({message:t.message||"操作成功",type:"success"}),e.searchParam(),e.roomDetailModelVisible=!1)}))},handleSelectionChange:function(e){this.selectedRooms=e},deleteRoom:function(){var e=this;this.selectedRooms.length?Object(c.c)({roomCodeList:this.selectedRooms.map(function(e){return e.roomCode})}).then(function(t){"0"===t.code&&Object(c.e)({roomCodeList:e.selectedRooms.map(function(e){return e.roomCode})}).then(function(t){"0"===t.code&&(e.$message({message:t.message,type:"success"}),e.searchParam())})}):this.$message.error("请先选择要删除的房间号")},handleCommand:function(e){var t=this,o={};if("number"==typeof e){if(!this.selectedRooms.length)return void this.$message.error("请选择需要设置房态的房间");o={roomCodes:this.selectedRooms.map(function(e){return e.roomCode}),roomStatus:e}}else o=e;Object(c.b)(o).then(function(e){if("0"===e.code){var a={};if(e.data.success===o.roomCodes.length)a={message:e.message,type:"success"};else if(e.data.fail===o.roomCodes.length)a={message:"失败"+e.data.fail+"个房间",type:"error"};else{var r=2===o.roomStatus?"空房":"已出租无租客";a={message:"成功"+e.data.success+"个房间，失败"+e.data.fail+"个房间，"+e.data.already+"个房间已经是"+r+"状态",type:"success"}}t.$message(a),t.searchParam()}})},checkEditStatus:function(e){this.$refs.roomDetailModel.checkEditFlag()?this.$confirm("您还有数据未保存, 确认关闭吗？").then(function(t){e()}).catch(function(e){}):e()}},filters:{setFloorName:function(e,t){if(t){var o=t.filter(function(t){return t.floorId===e});return o.length?o[0].floorName:""}},setRoomStatus:function(e,t){var o=t.filter(function(t){return t.value===e});return o.length?o[0].label:""}},mounted:function(){this.fetchEstateDetailData()},created:function(){this.fangyuanCode=this.$route.query.fangyuanCode||"",this.roomSearchForm.fangyuanCode=this.fangyuanCode},beforeDestroy:function(){var e=document.querySelectorAll("body > .el-dialog__wrapper");e&&[].forEach.call(e,function(e,t){document.body.removeChild(e)})}}},"j/ji":function(e,t,o){var a=o("CaX9");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("8bSs")("34da0739",a,!0)},r71q:function(e,t,o){var a=o("4Emy");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("8bSs")("59cc025c",a,!0)}});