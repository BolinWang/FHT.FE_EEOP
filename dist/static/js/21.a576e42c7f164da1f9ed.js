webpackJsonp([21],{"1FR4":function(e,t,a){var s=a("Alxp")(a("BimL"),a("ppnj"),function(e){a("TRJ9")},null,null);e.exports=s.exports},BimL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("U4Ig"),l=a.n(s),i=(a("0xDb"),a("QHcW"));t.default={name:"houseSync",components:{GridUnit:l.a},filters:{renderStatusType:function(e){return{"已发布":"success","发布中":"primary","发布失败":"danger","下架中":"warning","未发布":"info"}[e]||"info"},renderStatusValue:function(e){return e||"未知"}},data:function(){return{tabMapOptions:["整租","合租","集中式"],activeName:"整租",searchParams:{houseRentType:1,houseStatus:0,houseType:"",publishStatus:"",organizationName:"",keywords:"",mobileOrName:""},selectedItems:[],colModels:[{prop:"organizationName",label:"组织名称"},{prop:"name",label:"姓名",width:100},{prop:"mobile",label:"手机号",width:150},{prop:"userType",label:"用户类型",width:100},{prop:"address",label:"房源位置",width:200},{prop:"roomName",label:"公寓/小区-房间",width:200},{prop:"houseType",label:"房源类型",width:150},{prop:"roomCode",label:"房源编码",width:100},{prop:"rent",label:"房价(元/月)",width:100,align:"right"},{prop:"roomStatus",label:"房间状态",width:100,type:"status",fixed:"right",unitFilters:{renderStatusType:function(e){return{"已出租":"success","未出租":"info"}[e]||"info"},renderStatusValue:function(e){return e||"未知"}}},{prop:"publishStatus",label:"麦邻租房",width:100,type:"status",fixed:"right",unitFilters:{renderStatusType:function(e){return{"已发布":"success","未发布":"info","发布中":"primary"}[e]||"info"},renderStatusValue:function(e){return e||"未知"}}},{prop:"idlefishStatus",label:"闲鱼租房",width:100,slotName:"slot_popover",fixed:"right"},{prop:"operation",label:"操作记录",width:180}],tableHeight:300,url:i.p.defaultOptions.requestUrl,method:i.p.defaultOptions.method}},mounted:function(){var e=this;this.$nextTick(function(){var t=document.body.clientHeight-230-64-20;e.tableHeight=t>300?t:300,window.onresize=function(){return t=document.body.clientHeight-230-64-20,void(e.tableHeight=e.tableHeight=t>300?t:300)}})},computed:{tableStyle:function(){return{width:"100%",height:this.tableHeight+"px"}}},methods:{searchParam:function(e){var t=this;"clear"===e&&(this.searchParams={houseStatus:"",houseType:"",publishStatus:"",organizationName:"",keywords:"",mobileOrName:""}),this.searchParams.houseRentType="整租"===this.activeName?1:"合租"===this.activeName?2:0,this.$nextTick(function(){t.$refs.refGridUnit.searchHandler()})},handleClickTab:function(e){this.searchParam("clear")},handleSelectionChange:function(e){this.selectedItems=e},syncItems:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"on",a={on:{title:"发布",api:i.p.publish},off:{title:"撤销",api:i.p.offshlef}};return 0===this.selectedItems.length?(this.$message.error("请选择需要"+a[t].title+"的房源"),!1):this.selectedItems.filter(function(e){return"发布中"===e.idlefishStatus}).length>0?(this.$message.error("发布中的房源不能进行"+a[t].title),!1):0!==this.selectedItems.filter(function(e){return e.idlefishStatus===t}).length?(this.$message.error("已"+a[t].title+"的房源不能再"+a[t].title),!1):void this.$confirm("已选择"+this.selectedItems.length+"个房源，确定"+a[t].title+"吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.gotoHouseAsync(a[t].api)}).catch(function(){})},gotoHouseAsync:function(e){var t=this;e({platform:["idlefish"],roomCodes:this.selectedItems.map(function(e){return e.roomCode})}).then(function(e){t.$notify({title:"成功",message:"操作成功",type:"success",duration:2e3}),t.searchParam()})}}}},TRJ9:function(e,t,a){var s=a("c4wS");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);a("8bSs")("c261e5ca",s,!0)},c4wS:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,".model-search .filter-item{margin-left:10px}.item-select{width:150px}",""])},ppnj:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClickTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[e._l(e.tabMapOptions,function(e,t){return a("el-tab-pane",{key:t,attrs:{label:e,name:e}})}),e._v(" "),a("el-form",{staticClass:"model-search clearfix",attrs:{inline:!0,size:"small"}},[a("div",[a("el-select",{staticClass:"item-select",attrs:{size:"small",filterable:"",clearable:"",placeholder:"房间状态"},model:{value:e.searchParams.houseStatus,callback:function(t){e.$set(e.searchParams,"houseStatus",t)},expression:"searchParams.houseStatus"}},[a("el-option",{attrs:{label:"已出租",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未出租",value:0}})],1),e._v(" "),a("el-select",{staticClass:"item-select filter-item",attrs:{size:"small",filterable:"",clearable:"",placeholder:"房间类型"},model:{value:e.searchParams.houseType,callback:function(t){e.$set(e.searchParams,"houseType",t)},expression:"searchParams.houseType"}},[a("el-option",{attrs:{label:"普通",value:0}}),e._v(" "),a("el-option",{attrs:{label:"金融",value:1}}),e._v(" "),a("el-option",{attrs:{label:"飞虎队",value:2}})],1),e._v(" "),a("el-select",{staticClass:"item-select filter-item",attrs:{size:"small",filterable:"",clearable:"",placeholder:"麦邻发布状态"},model:{value:e.searchParams.publishStatus,callback:function(t){e.$set(e.searchParams,"publishStatus",t)},expression:"searchParams.publishStatus"}},[a("el-option",{attrs:{label:"未发布",value:0}}),e._v(" "),a("el-option",{attrs:{label:"已发布",value:1}}),e._v(" "),a("el-option",{attrs:{label:"发布中",value:2}})],1),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchParam}},[e._v("查询")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"small",icon:"el-icon-remove-outline"},on:{click:function(t){e.searchParam("clear")}}},[e._v("清空")])],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{size:"small",clearable:"",placeholder:"组织名称"},model:{value:e.searchParams.organizationName,callback:function(t){e.$set(e.searchParams,"organizationName",t)},expression:"searchParams.organizationName"}}),e._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{size:"small",clearable:"",placeholder:"手机号/姓名"},model:{value:e.searchParams.mobileOrName,callback:function(t){e.$set(e.searchParams,"mobileOrName",t)},expression:"searchParams.mobileOrName"}}),e._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{size:"small",clearable:"",placeholder:"公寓/小区"},model:{value:e.searchParams.keywords,callback:function(t){e.$set(e.searchParams,"keywords",t)},expression:"searchParams.keywords"}}),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"success",icon:"el-icon-upload"},on:{click:function(t){e.syncItems("on")}}},[e._v("发布")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"danger",icon:"el-icon-remove"},on:{click:function(t){e.syncItems("off")}}},[e._v("撤销")])],1)]),e._v(" "),a("GridUnit",{ref:"refGridUnit",attrs:{columns:e.colModels,formOptions:e.searchParams,url:e.url,showSelection:!0,pageSizes:[50,100,200,500],dataMethod:e.method,height:e.tableHeight},on:{"selection-change":e.handleSelectionChange},scopedSlots:e._u([{key:"slot_popover",fn:function(t){return["发布失败"===t.row.idlefishStatus?a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("发布失败原因: "+e._s(t.row.failReason))]),e._v(" "),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{type:e._f("renderStatusType")(t.row.idlefishStatus)}},[e._v("\n              "+e._s(e._f("renderStatusValue")(t.row.idlefishStatus))+"\n            ")])],1)]):a("el-tag",{attrs:{type:e._f("renderStatusType")(t.row.idlefishStatus)}},[e._v("\n          "+e._s(e._f("renderStatusValue")(t.row.idlefishStatus))+"\n        ")])]}}])})],2)],1)},staticRenderFns:[]}}});